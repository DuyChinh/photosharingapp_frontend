import{_ as q,c as u,h as m,b as e,d as A,p as v,e as V,v as M,F as Y,r,s as L,x as H,l as D,j,k as O,t as g,z as R,R as W,n as J,w as T}from"./index-2_RHQBdH.js";import{H as G}from"./index-CNzOuQEG.js";import{a as B}from"./axios-luKMr0Q6.js";import{h as P}from"./moment-C5S46NFB.js";import{L as K}from"./index-b2S-CQiE.js";import"./index-DW_MHI2K.js";const Q={__name:"ChangeInfo",props:{isChangeInfo:{type:Boolean},user:{type:Object},getUser:{type:Function}},emits:["changeInfo"],setup(z,{expose:a,emit:N}){a();const t=JSON.parse(localStorage.getItem("userData")),h=localStorage.getItem("token"),S=r(),o=r(),b=r(),_=r(),p=r(),y=r(!1),i=z,k=N,C=()=>{var x,s,d,f,I;S.value=(x=i.user)==null?void 0:x.username,o.value=(s=i.user)==null?void 0:s.fullname,b.value=P((d=i.user)==null?void 0:d.dob).format("DD/MM/YYYY"),_.value=(f=i.user)==null?void 0:f.phone,p.value=(I=i.user)==null?void 0:I.address};L(C);const U={userData:t,token:h,username:S,fullname:o,birthday:b,phone:_,address:p,loading:y,props:i,emit:k,setDefault:C,handleChangeInfo:async()=>{var s;const x={username:S.value,fullname:o.value,dob:b.value,phone:_.value,address:p.value};await B.patch(`/users/${(s=i.user)==null?void 0:s._id}`,x,{headers:{Authorization:`Bearer ${h}`}}).then(d=>{D.success(d.data.message),i.getUser()}).catch(d=>{var f,I;D.error(((I=(f=d.response)==null?void 0:f.data)==null?void 0:I.message)||"update failed!Please try again!")}).finally(()=>{})},ref:r,watch:H,watchEffect:L,get axios(){return B},get toast(){return D},get moment(){return P}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}},X={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Z={class:"modal-dialog modal-dialog-centered"},$={class:"modal-content"},ee={class:"modal-body"},ae={class:"input-group mb-3"},te={class:"input-group mb-3"},se={class:"input-group mb-3"},oe={class:"input-group mb-3"},le={class:"input-group mb-3"};function ne(z,a,N,t,h,S){return m(),u(Y,null,[e("div",X,[e("div",Z,[e("div",$,[a[11]||(a[11]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5 text-success",id:"exampleModalLabel"},[e("i",{class:"bi bi-pencil-square text-warning"}),v(" Change Info")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",ee,[e("form",null,[e("div",ae,[a[5]||(a[5]=e("span",{class:"input-group-text text-warning",id:"basic-addon1"},"@",-1)),V(e("input",{type:"text",class:"form-control",placeholder:"Email","aria-label":"Email","aria-describedby":"basic-addon1","onUpdate:modelValue":a[0]||(a[0]=o=>t.username=o),readonly:""},null,512),[[M,t.username]])]),e("div",te,[a[6]||(a[6]=e("span",{class:"input-group-text",id:"basic-addon1"},[e("i",{class:"bi bi-person-fill-lock text-primary"})],-1)),V(e("input",{type:"text",class:"form-control",placeholder:"Full name","aria-label":"Full name","aria-describedby":"basic-addon1","onUpdate:modelValue":a[1]||(a[1]=o=>t.fullname=o)},null,512),[[M,t.fullname]])]),e("div",se,[a[7]||(a[7]=e("span",{class:"input-group-text",id:"basic-addon1"},[e("i",{class:"bi bi-calendar2-week-fill text-info"})],-1)),V(e("input",{type:"text",class:"form-control",placeholder:"Birthday 01/01/2025","aria-label":"Birthday","aria-describedby":"basic-addon1","onUpdate:modelValue":a[2]||(a[2]=o=>t.birthday=o)},null,512),[[M,t.birthday]])]),e("div",oe,[a[8]||(a[8]=e("span",{class:"input-group-text",id:"basic-addon1"},[e("i",{class:"bi bi-telephone-fill text-danger"})],-1)),V(e("input",{type:"number",class:"form-control",placeholder:"Phone","aria-label":"Phone","aria-describedby":"basic-addon1","onUpdate:modelValue":a[3]||(a[3]=o=>t.phone=o)},null,512),[[M,t.phone]])]),e("div",le,[a[9]||(a[9]=e("span",{class:"input-group-text",id:"basic-addon1"},[e("i",{class:"bi bi-geo-alt-fill text-success"})],-1)),V(e("input",{type:"text",class:"form-control",placeholder:"Address","aria-label":"Address","aria-describedby":"basic-addon1","onUpdate:modelValue":a[4]||(a[4]=o=>t.address=o)},null,512),[[M,t.address]])])])]),e("div",{class:"modal-footer"},[a[10]||(a[10]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t.handleChangeInfo},"Save changes")])])])]),A(` <div class="d-flex justify-content-center">
            <div
                class="border rounded"
                data-coreui-locale="en-US"
                data-coreui-start-date="2024/02/13"
                data-coreui-toggle="calendar"
            ></div>
        </div> `)],2112)}const ie=q(Q,[["render",ne],["__file","/Users/doanduychinh/Documents/photosharingapp_frontend/src/views/home/ChangeInfo.vue"]]),re={__name:"index",setup(z,{expose:a}){a();const N=r(!1),t=r(!1),h=JSON.parse(localStorage.getItem("userData")),S="https://photosharingapp.up.railway.app",o=localStorage.getItem("token"),b=r(h),_=r(),p=r([]),y=r([]),i=r([]),k=r(""),C=async()=>{var n;t.value=!0,await B.get(`/users/${(n=b.value)==null?void 0:n._id}`,{headers:{Authorization:`Bearer ${o}`}}).then(l=>{_.value=l.data.data}).catch(l=>{var c,w;D.error((w=(c=l.response)==null?void 0:c.data)==null?void 0:w.message)}).finally(()=>{t.value=!1})};L(C);const F=async()=>{t.value=!0,await B.get("/users",{headers:{Authorization:`Bearer ${o}`}}).then(n=>{let l=n.data.data;const c=l.find(w=>w._id===h._id);l=l.filter(w=>w._id!==h._id),p.value=[c,...l],y.value=p.value}).catch(n=>{var l,c;D.error((c=(l=n.response)==null?void 0:l.data)==null?void 0:c.message)}).finally(()=>{t.value=!1})};L(F);const U=async()=>{t.value=!0,await B.get(`/photos?userId=${b.value._id}`,{headers:{Authorization:`Bearer ${o}`}}).then(n=>{i.value=n.data.data,b.value._id!==h._id&&(i.value=i.value.filter(l=>l.share_status==="public"))}).catch(n=>{var l,c;D.error((c=(l=n.response)==null?void 0:l.data)==null?void 0:c.message)}).then(()=>{t.value=!1})};L(U);const x=n=>{b.value=n},s=()=>{N.value=!0},d=n=>n.normalize("NFD").replace(/[\u0300-\u036f]/g,""),f=()=>{k.value?p.value=y.value.filter(n=>d(n.fullname.toLowerCase()).includes(d(k.value.toLowerCase()))):p.value=y.value};L(f);const E={isChangeInfo:N,loading:t,userData:h,baseUrl:S,token:o,currentUser:b,user:_,users:p,root_users:y,photos:i,searchWord:k,getUser:C,getUsers:F,fetchPhotos:U,changeCurrentUser:x,handleChangeInfo:s,removeDiacritics:d,searchUser:f,handleFollowClick:async n=>{await B.patch(`/users/follow/${n._id}`,{},{headers:{Authorization:`Bearer ${o}`}}).then(l=>{F()}).catch(l=>{var c,w;D.error((w=(c=l.response)==null?void 0:c.data)==null?void 0:w.message)}).finally(()=>{})},ref:r,watch:H,watchEffect:L,Header:G,ChangeInfo:ie,Loading:K,get axios(){return B},get moment(){return P},get toast(){return D},get RouterLink(){return W}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},de={class:""},ce={class:"row gap-3 flex-nowrap"},ue={class:"col-md-3"},me={class:"list-group",style:{"max-height":"calc(100vh - 100px)","overflow-y":"scroll"}},be=["onClick"],pe={class:"mb-1"},fe={class:"mb-1"},ge={class:"d-flex justify-content-between align-items-center"},he={class:"btn btn-success btn-sm"},ve={key:0,class:"bi bi-bookmark-check-fill text-warning"},_e=["onClick"],ye={class:"card col-md-4 intro"},xe={class:"card-body"},we={key:0,class:"card-text"},ke={key:1,class:"card-text"},Ce={class:"card-text"},Ue={class:"card-text"},Ie={class:"card-text"},De={class:"card-text"},Se={class:"card-text"},Fe={class:"card col-md-4 library"},Le={class:"card-body"},Be={key:0,class:"d-flex align-items-center flex-direction-row mt-3 flex-wrap",style:{width:"100%",gap:"20px"}},Ne=["src"],Ve={key:1,class:"no-image text-center text-black"};function Me(z,a,N,t,h,S){var o,b,_,p,y,i,k,C,F,U,x;return m(),u("div",null,[j(t.Header,{class:"mb-2"}),e("div",de,[e("div",ce,[e("div",ue,[e("div",me,[V(e("input",{type:"text",class:"form-control mb-2",placeholder:"Search user","aria-label":"Search user","aria-describedby":"button-addon2","onUpdate:modelValue":a[0]||(a[0]=s=>t.searchWord=s)},null,512),[[M,t.searchWord]]),(m(!0),u(Y,null,O(t.users,s=>{var d,f;return m(),u("div",{class:J(["list-group-item list-group-item-action",t.currentUser._id===s._id?"active":""]),"aria-current":"true",onClick:I=>t.changeCurrentUser(s),style:{cursor:"pointer"},key:s.id},[e("h5",pe,g(s.fullname),1),e("p",fe,"@"+g(s.username),1),e("div",ge,[e("button",he,g((d=s==null?void 0:s.follow)==null?void 0:d.length)+" follower",1),s._id===t.userData._id?(m(),u("i",ve)):(m(),u("span",{key:1,class:"badge rounded-pill text-bg-danger",onClick:T(I=>t.handleFollowClick(s),["stop"])},g((f=s==null?void 0:s.follow)!=null&&f.includes(t.userData._id)?"Following":"Follow"),9,_e))])],10,be)}),128))])]),e("div",ye,[e("div",xe,[a[10]||(a[10]=e("h5",{class:"card-title mb-4 d-flex justify-content-between aligns-item-center"},"Introduce ",-1)),(b=(o=t.user)==null?void 0:o.username)!=null&&b.includes("@")?(m(),u("p",we,[a[2]||(a[2]=e("i",{class:"bi bi-envelope-at-fill text-warning"},null,-1)),v(" Email: "+g((_=t.user)==null?void 0:_.username),1)])):(m(),u("p",ke,[a[3]||(a[3]=e("i",{class:"bi bi-envelope-at-fill text-warning"},null,-1)),v(" Username: "+g((p=t.user)==null?void 0:p.username),1)])),e("p",Ce,[a[4]||(a[4]=e("i",{class:"bi bi-person-fill-lock text-primary"},null,-1)),v(" Full name:"+g((y=t.user)==null?void 0:y.fullname),1)]),e("p",Ue,[a[5]||(a[5]=e("i",{class:"bi bi-calendar2-week-fill text-info"},null,-1)),v(" Birthday: "+g((i=t.user)!=null&&i.dob?t.moment(t.user.dob).format("DD/MM/YYYY"):"Not available"),1)]),e("p",Ie,[a[6]||(a[6]=e("i",{class:"bi bi-telephone-fill text-black"},null,-1)),v(" Phone: "+g((k=t.user)!=null&&k.phone?t.user.phone:"Not available"),1)]),e("p",De,[a[7]||(a[7]=e("i",{class:"bi bi-geo-alt-fill text-success"},null,-1)),v(" Address: "+g((C=t.user)!=null&&C.address?t.user.address:"Not avaiable"),1)]),e("p",Se,[a[8]||(a[8]=e("i",{class:"bi bi-person-check-fill text-black"},null,-1)),v(" Follow: "+g((U=(F=t.user)==null?void 0:F.follow)==null?void 0:U.length),1)]),((x=t.user)==null?void 0:x._id)==t.userData._id?(m(),u("button",{key:2,class:"btn btn-primary mt-4",onClick:t.handleChangeInfo,"data-bs-toggle":"modal","data-bs-target":"#exampleModal"},a[9]||(a[9]=[e("i",{class:"bi bi-pen-fill"},null,-1),v(" Change my info")]))):A("v-if",!0)])]),e("div",Fe,[e("div",Le,[a[13]||(a[13]=e("h5",{class:"card-title d-flex justify-content-between aligns-item-center"},"Library",-1)),t.photos.length>0?(m(),u("div",Be,[(m(!0),u(Y,null,O(t.photos,s=>(m(),u("div",{class:"img_item",key:s._id},[j(t.RouterLink,{to:{path:"/photo",query:{id:s._id}}},{default:R(()=>[e("img",{src:`${t.baseUrl}/images/${s.img}`,class:"",alt:"..."},null,8,Ne)]),_:2},1032,["to"]),A(' <img :src="`${baseUrl}/images/${photo.img}`" class="" alt="..."> ')]))),128))])):(m(),u("div",Ve,a[11]||(a[11]=[e("i",{class:"bi bi-image text-black",style:{"font-size":"2rem"}},null,-1),e("p",{class:"mt-2 text-black"},"No images available",-1)]))),A(' <Loading style="height: 30px;" v-if="loading"/> '),j(t.RouterLink,{to:{path:"/library",query:{user_id:t.currentUser._id}}},{default:R(()=>a[12]||(a[12]=[e("button",{class:"btn btn-info text-white mt-5"},[e("i",{class:"bi bi-images"}),v(" View all library")],-1)])),_:1},8,["to"])])])])]),j(t.ChangeInfo,{isChangeInfo:t.isChangeInfo,"onUpdate:isChangeInfo":a[1]||(a[1]=s=>t.isChangeInfo=s),user:t.user,getUser:t.getUser},null,8,["isChangeInfo","user"])])}const Oe=q(re,[["render",Me],["__scopeId","data-v-2c5296db"],["__file","/Users/doanduychinh/Documents/photosharingapp_frontend/src/pages/home/index.vue"]]);export{Oe as default};
